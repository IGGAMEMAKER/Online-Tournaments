//

mixin drawRegs(msg)
	each val in msg
		+drawReg(val)
mixin drawReg(val)
	tr 
		td 
			+tLink(val.tournamentID)
		//td #{val.promo}
		td регистрация
		td
			a(href="#") сняться с турнира

mixin tLink(id)
	i #{id}


///Dublicate from ShowGifts.jade
mixin ShowGift(gift,add)
	td
		center
			h2!= gift.name
		
			//p!='URL = '+gift.photoURL
			img(src= gift.photoURL display=block max-width='300px' width='400px')
			br
			- if (gift.URL)
				a(href=gift.URL) Show more
			p!=gift.description
			p!=gift.price+'$'
			//p!= '----------------------------'

mixin showGifts(gifts)
	table
		each val, index in gifts
			if(index%3==0 && index!=0)
				tr
					+ShowGift(val)
			else
				+ShowGift(val)

mixin drawPrizes2(giftIDList, gifts)
	if giftIDList && gifts
		table
			each gft, index in giftIDList
				//p!= JSON.stringify(gft)
				- for (var i=0;i<gifts.length;i++)
					if gft.giftID == gifts[i]._id
						tr
							+ShowGift(gifts[i])
						//
							if(index%3==0)
								//tr
									td
										p TR
										//+ShowGift(gifts[i])
							else
								+ShowGift(gifts[i])
		
///-----
mixin buttonLink(link, text)
	form(action=link) 
		input(type="submit" value=text style="width:125px;height:50px;")

mixin drawPrizes(gifts)
	h2 Prizes:
	if gifts && gifts.length>0
		+showGifts(gifts)
	else
		h3 You have no prizes, but it's high time to win them!

mixin moneyOperations()
	//a(href="MoneyTransfers") Money HISTORY
	br
	//table(width="300px")
		tr
			td
				+buttonLink('Deposit', 'Deposit money')
			td
				+buttonLink('Cashout', 'Cashout')
	br

mixin info()
	//include templates/account
	+drawAccount(msg.email)
	//+drawAccount(msg.email)

mixin drawAccount(email)
	//div(class="bloc l-bloc bgc-white bloc-tile-2" id="bloc-6")
		div(class="container bloc-lg")

	div(class="panel")
		div(class="panel-heading")
			h3(class="mg-clear") Данные профиля
		div(class="panel-body")
			form(id="form-928" novalidate)
				div(class="form-group")
					label Имя
					h4(class="mg-md") #{session.login}
				div(class="form-group")
					label Email
					h4(class="mg-md") #{email}
				div(class="form-group")
					label Баланс
					h4(class="mg-md" id="money1") 0

mixin drawTournamentRegs(tournaments)
	//div(class="bloc l-bloc bgc-white bloc-tile-2" id="bloc-6")
		div(class="container bloc-lg")
			div(class="row")
	div(class="col-sm-12 text-center")
		if tournaments && tournaments.length>0
			center
				table(class="table table-bordered panel" style="width:50%;")
					thead
						tr
							th №
							//th Приглашён
							th Статус
							th Действие
		
					tbody
						+drawRegs(tournaments)
		else
			h3 Вы не зарегистрированы ни в одном турнире(
			a(href="Tournaments") Начните играть !

mixin changePass()
	include templates/changepassword

mixin deposit()
	include templates/deposit

mixin cashout()
	include templates/cashout

mixin modal()
	button(type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModal") Open Modal

	div(id="myModal" class="modal fade" role="dialog")
		div(class="modal-dialog")
			div(class="modal-content")
				div(class="modal-header")
					button(type="button" class="close" data-dismiss="modal") &times;
					h4(class="modal-title") Modal Header
				div(class="modal-body")
					p Some text in the modal.
				div(class="modal-footer")
					button(type="button" class="btn btn-default" data-dismiss="modal") Close

//html
	head
		include templates/head
	//p!= JSON.stringify(msg.gifts)(msg.userGifts)
	
	//script(src="loadProfile.js")
	
	div(class="page-container")
		include client
		+title("Профиль")
		div(class="bloc l-bloc bgc-white b-divider" id="hq1")
			div(class="container bloc-sm")
				+small_title("Мои турниры")
				div(class="bloc-group")
					+drawTournamentRegs(msg.tournaments)

				div(class="bloc-group")
					+info()
					+changePass()

				+title("Денежные операции")
				div(class="bloc-group")
					+deposit()
					+cashout()
		include templates/footer

extends layout

block content
	//div(class="page-container")
		//include client
		h2(class="text-center white") Профиль
		div(class="bloc l-bloc bgc-white b-divider" id="hq1")
			div(class="container bloc-sm")
				h2(class="text-center  white") Мои турниры
				div(class="bloc-group")
					+drawTournamentRegs(msg.tournaments)

				div(class="bloc-group")
					+info()
					+changePass()

				h2(class="text-center  white") Денежные операции
				div(class="bloc-group")
					+deposit()
					+cashout()
	div(class="col-sm-12")
		h2(class="text-center white") Профиль
	div(class="col-sm-12")
		h2(class="text-center  white") Мои турниры
		+drawTournamentRegs(msg.tournaments)
	div(class="col-sm-12")
		div(class="col-sm-6 col-xs-12 killPaddings")
			+info()
		div(class="col-sm-6 col-xs-12 killPaddings")
			+changePass()
	div(class="col-sm-12")
		h2(class="text-center white") Денежные операции
		div(class="col-sm-6 col-xs-12 killPaddings")
			+deposit()
		div(class="col-sm-6 col-xs-12 killPaddings")
			+cashout()
